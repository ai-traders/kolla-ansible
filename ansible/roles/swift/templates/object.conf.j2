[DEFAULT]
max_clients = 1024
disable_fallocate = true
bind_ip = {{ hostvars[inventory_hostname]['ansible_' + storage_interface]['ipv4']['address'] }}
bind_port = {{ swift_object_server_port }}
devices = {{ swift_devices_mount_point }}
mount_check = false
log_udp_host = {{ api_interface_address }}
log_udp_port = {{ fluentd_syslog_port }}
log_name = {{ service_name }}
log_facility = LOG_LOCAL0
log_level = {{ swift_log_level }}
workers = {{ openstack_service_workers }}

[pipeline:main]
{% if service_name == 'swift-object-expirer' %}
pipeline = proxy-server
{% else %}
pipeline = object-server
{% endif %}

[app:object-server]
{% if swiftonfile | bool %}
use = egg:swiftonfile#object
user = swift
disk_chunk_size = 65536
{% else %}
use = egg:swift#object
{% endif %}

{% if service_name == 'swift-object-auditor' %}
[object-auditor]
{% endif %}

[object-replicator]
{% if service_name == 'swift-object-replicator' %}
sync_module = {replication_ip}:{meta}:object
{% endif %}

{% if service_name == 'swift-object-updater' %}
[object-updater]
{% endif %}

{% if service_name == 'swift-object-expirer' %}
[object-expirer]

[app:proxy-server]
use = egg:swift#proxy
{% endif %}
